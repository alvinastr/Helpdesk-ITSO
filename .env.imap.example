# ============================================
# IMAP Configuration (Auto-Fetch Emails)
# ============================================
# Untuk auto-create tickets dari email masuk

# IMAP Server Configuration
IMAP_HOST=imap.gmail.com
IMAP_PORT=993
IMAP_ENCRYPTION=ssl
IMAP_VALIDATE_CERT=true

# IMAP Credentials
# Gmail: Gunakan App Password (bukan password biasa)
# Outlook: Gunakan email & password normal
IMAP_USERNAME=it.infrastructure@bankmega.com
IMAP_PASSWORD=your_app_password_here

# Fetch Settings
IMAP_FETCH_LIMIT=50  # Maximum emails to process per fetch (default: 50)

# ============================================
# EMAIL FILTERING (IMPORTANT!)
# ============================================
# Filter email yang akan diproses agar hanya email relevan

# 1. Filter by Sender Domain (Whitelist)
# Hanya email dari domain ini yang diproses (pisahkan dengan koma)
# Leave empty untuk allow ALL domains
IMAP_ALLOWED_DOMAINS=bankmega.com,gmail.com
# Example: IMAP_ALLOWED_DOMAINS=bankmega.com
# Example: IMAP_ALLOWED_DOMAINS=bankmega.com,external-partner.com

# 2. Filter by Recipient
# Email harus dikirim ke salah satu alamat ini (TO atau CC)
# Leave empty untuk allow ALL recipients
IMAP_VALID_RECIPIENTS=it.infrastructure@bankmega.com,support@bankmega.com
# Example: IMAP_VALID_RECIPIENTS=it.infrastructure@bankmega.com

# 3. Filter by Subject Keywords
# Subject harus mengandung minimal salah satu keyword
# Leave empty untuk allow ALL subjects
IMAP_REQUIRED_KEYWORDS=bantuan,help,support,masalah,problem,error,urgent
# Example: IMAP_REQUIRED_KEYWORDS=bantuan,help,support

# 4. Minimum Content Length
# Skip email dengan body terlalu pendek (karakter)
IMAP_MIN_CONTENT_LENGTH=20

# 5. Fetch Time Range
# Hanya fetch email dari X hari terakhir
# Leave empty untuk fetch ALL unread emails
IMAP_FETCH_DAYS_BACK=30
# Example: IMAP_FETCH_DAYS_BACK=7 (only last 7 days)

# ============================================
# Contoh Konfigurasi untuk Strict Filtering
# ============================================
# Uncomment ini untuk strict filtering:
# IMAP_ALLOWED_DOMAINS=bankmega.com
# IMAP_VALID_RECIPIENTS=it.infrastructure@bankmega.com
# IMAP_REQUIRED_KEYWORDS=bantuan,help,support,masalah,problem
# IMAP_MIN_CONTENT_LENGTH=50
# IMAP_FETCH_DAYS_BACK=7

# ============================================
# Contoh Konfigurasi untuk No Filtering
# ============================================
# Uncomment ini untuk allow ALL emails:
# IMAP_ALLOWED_DOMAINS=
# IMAP_VALID_RECIPIENTS=
# IMAP_REQUIRED_KEYWORDS=
# IMAP_MIN_CONTENT_LENGTH=10
# IMAP_FETCH_DAYS_BACK=

# ============================================
# Contoh untuk Gmail
# ============================================
# 1. Buka Gmail Settings → Forwarding and POP/IMAP
# 2. Enable "IMAP Access"
# 3. Generate App Password:
#    - Google Account → Security → 2-Step Verification
#    - App passwords → Generate untuk "Mail"
#    - Copy 16-digit password (e.g., "abcd efgh ijkl mnop")
# 4. Paste di IMAP_PASSWORD

# ============================================
# Contoh untuk Outlook/Exchange
# ============================================
# IMAP_HOST=outlook.office365.com
# IMAP_PORT=993
# IMAP_USERNAME=it.infrastructure@bankmega.com
# IMAP_PASSWORD=actual_password

# ============================================
# Testing
# ============================================
# Test manual: php artisan emails:fetch
# Check logs: tail -f storage/logs/laravel.log
